

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Importing Models &mdash; python 81a documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parameters" href="parameters.html" />
    <link rel="prev" title="Wind Models" href="wind_models.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> python
          

          
          </a>

          
            
            
              <div class="version">
                81
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../input.html">Inputs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_description.html">System Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="wind_models.html">Wind Models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Importing Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html">Parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dummy.html">Dummy Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meta.html">Meta-documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick.html"><em>Quick Guide to Python</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../sv.html">The Shlosman &amp; Vitello prescription of a bi-conical wind</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../input.html">Inputs</a> &raquo;</li>
        
      <li>Importing Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/input/importing_models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="importing-models">
<h1>Importing Models<a class="headerlink" href="#importing-models" title="Permalink to this headline">¶</a></h1>
<p>Python can read 1D or 2.5D grids of density and velocity, instead of setting up the model from an analytic prescription. Caution should be exercised with this mode, as it is still in a development phase, and the mode requires the user to ensure that things like mass and angular momentum conservation are enforced.</p>
<p>This mode is activated via wind type option “imported”, which triggers an extra question, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wind</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">SV</span><span class="p">,</span><span class="n">star</span><span class="p">,</span><span class="n">hydro</span><span class="p">,</span><span class="n">corona</span><span class="p">,</span><span class="n">kwd</span><span class="p">,</span><span class="n">homologous</span><span class="p">,</span><span class="n">shell</span><span class="p">,</span><span class="n">imported</span><span class="p">)</span>             <span class="n">imported</span>
<span class="n">Wind</span><span class="o">.</span><span class="n">coord_system</span><span class="p">(</span><span class="n">spherical</span><span class="p">,</span><span class="n">cylindrical</span><span class="p">,</span><span class="n">polar</span><span class="p">,</span><span class="n">cyl_var</span><span class="p">)</span>          <span class="n">cylindrical</span>
<span class="n">Wind</span><span class="o">.</span><span class="n">model2import</span>                    <span class="n">cv</span><span class="o">.</span><span class="n">import</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>An example in cylindrical geometry, <code class="code docutils literal notranslate"><span class="pre">cv_import.pf</span></code>, is given with a supplementary grid file in <code class="code docutils literal notranslate"><span class="pre">examples/beta/</span></code>.
The format expected in the grid input file for such
a cylindrical model is as follows, although the column headers lines are actually not read.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span>  <span class="n">j</span>  <span class="n">inwind</span>    <span class="n">x</span>      <span class="n">z</span>     <span class="n">v_x</span>   <span class="n">v_y</span>   <span class="n">v_z</span>     <span class="n">rho</span>   <span class="n">t_r</span>
<span class="o">--</span> <span class="o">--</span> <span class="o">------</span>  <span class="o">-----</span>  <span class="o">-----</span>  <span class="o">-----</span> <span class="o">-----</span> <span class="o">-----</span>   <span class="o">-----</span> <span class="o">-----</span>
<span class="mi">0</span>  <span class="mi">0</span>    <span class="o">-</span><span class="mi">1</span>    <span class="mf">1.4e9</span>  <span class="mf">3.5e9</span>   <span class="mf">0.0</span>   <span class="mf">0.0</span>   <span class="mf">6e5</span>     <span class="mf">0.0</span>   <span class="mf">0.0</span>
<span class="mi">0</span>  <span class="mi">1</span>     <span class="mi">0</span>    <span class="mf">1.4e9</span>  <span class="mf">3.5e10</span>  <span class="mf">1e5</span>   <span class="mf">0.0</span>   <span class="mf">2e6</span>     <span class="mf">1e9</span>   <span class="mf">0.0</span>
</pre></div>
</div>
<p>where all physical units are CGS. i and j refer to the rows and
columns of the wind cells respectively, while inwind tells the code whether
the cell is in the wind (<code class="code docutils literal notranslate"><span class="pre">0</span></code>), or out of the wind (<code class="code docutils literal notranslate"><span class="pre">-1</span></code>). If a
partially in wind flag is provided (<code class="code docutils literal notranslate"><span class="pre">1</span></code>), the code defaults to treating this
cell as not in the wind. This could in principle be adapted, but means that for the moment
this mode is most useful when using models with sufficiently high resolution or covering factors
that partially in wind cells
are unimportant.</p>
<p>The other input files have slightly different formats.  The best way to see the format is use the process described at the end of the page.</p>
<div class="section" id="creating-your-own-model">
<h2>Creating your own model<a class="headerlink" href="#creating-your-own-model" title="Permalink to this headline">¶</a></h2>
<p>In order to create your own model, there are a few important things to consider:</p>
<ul class="simple">
<li><p>all units should be CGS (except for indices and flags, which are integers)</p></li>
<li><p>x and z for cylindrical (or r and theta for spherical polar) coordinates are supplied at the edges, rather than centres, of cells. Thus, a given cell is described by the location of it’s bottom left hand corner in (x,z) space.</p></li>
<li><p>Ghost cells <strong>must</strong> be included. This means that additional rows and columns of cells must be included at the edges of the grid, and they must be excluded from the wind so that their velocities and densities are set to zero, but have a velocity that python can interpolate with.</p></li>
<li><p>i and j correspond to rows and columns respectively, so that the first row of cells at the disk plane has i = 0.</p></li>
<li><p>rho the density of the cell in cgs units</p></li>
<li><p>The t_r column is currently not used, although it could be in future</p></li>
</ul>
<p>Although <code class="code docutils literal notranslate"><span class="pre">cv_import.pf</span></code> is designed to closely match the
<code class="code docutils literal notranslate"><span class="pre">cv_standard.pf</span></code> model, it does not match the model perfectly as
the imported model does not deal with ‘partially in wind’ cells. As such,
we generally recommend imported models are used for either wind models
that entirely fill the grid or that have sufficiently high resolution
that the partial filled cells are relatively unimportant.</p>
</div>
<div class="section" id="generating-example-inputs-for-testing-and-familiarizing-oneself-with-python-s-import-capability">
<h2>Generating example inputs for testing and familiarizing oneself with Python’s import capability<a class="headerlink" href="#generating-example-inputs-for-testing-and-familiarizing-oneself-with-python-s-import-capability" title="Permalink to this headline">¶</a></h2>
<p>If one is trying to use the import capability of Python for the first time,
it will be useful to familiarize oneself with the process, and the file format for a particular coordinate system,
by running first running Python on a model that is something similar to model to be imported,
but which takes advantage of one of the kinematic models available with the code.</p>
<p>For example, suppose you have a hydrodynamical simulation of an AGN wind which
is in polar coordinates and you want to use Python to calculate the spectrum.
Then you might create a model of an AGN with a similar coordinate system using, say, a Knigge Wood &amp; Drew wind (and similar atomic data).
For specificity, suppose this model has the root name “test”</p>
<p>Once you have run the model, you can create an import file file by first running the routine <code class="code docutils literal notranslate"><span class="pre">windsave2table</span></code>, or more specifically:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>windsave2table <span class="nb">test</span>
</pre></div>
</div>
<p>This produces a large number of ascii tables, which are described elsewhere</p>
<p>In the py_progs directory, you will find 3 scripts, <code class="code docutils literal notranslate"><span class="pre">import_1d.py</span></code>, <code class="code docutils literal notranslate"><span class="pre">import_cyl.py</span></code> and <code class="code docutils literal notranslate"><span class="pre">import_rtheta.py</span></code>,
which will convert one of the output files <code class="code docutils literal notranslate"><span class="pre">test.0.master.txt</span></code> to an import file, <code class="code docutils literal notranslate"><span class="pre">test.import.txt</span></code>,
that can be used with the import mode of Python. The 3 different routines are for 1d spherical coordinates,
and polar (r-theta) coordinates respectively.</p>
<p>Assuming the py_progs directory is in your PATH, and given that our example is for cylindrical coordinates, one would run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>import_cyl.py <span class="nb">test</span>
</pre></div>
</div>
<p>At that point, you can test this import file, by modifying the first .pf file to import mode (imported).
Running Python on this file, will result in your being asked the name of the import file,
and give you a “baseline” to import the hydrodynamical simulation to work.</p>
<p>Note that one should not assume that spectra produced by the original run of Python and the run of the imported model will be identical.
There are several reasons for this:</p>
<p>First, in creating the original model, Python accounts for the possibility that some cells are partially in the wind.
This is not possible in the imported models. Only cells that are complete in the wind are counted.</p>
<p>Second, within Python, positions and velocities are assumed defined at the corners of cells, whereas densities are assumed to be cell centered.
If one provides a table where all of the quantities are at the same exact position (namely density is at the same position as x),
there will be a slight discrepancy between the way in model as calculated internally and as represented within Python.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parameters.html" class="btn btn-neutral float-right" title="Parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wind_models.html" class="btn btn-neutral float-left" title="Wind Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Knox Long, Christian Knigge, Stuart Sims, Nick Higginbottom, James Matthews, Sam Mangham, Edward Parkinson, Mandy Hewitt

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>